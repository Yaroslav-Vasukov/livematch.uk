{% extends "../layouts/_base.html" %} 
{% set currentPage = 'post' %}
{% block title %}Post{% endblock %} 
{% block active_nav %}Post{% endblock %} 
{% block body_class %}page page--post{% endblock %} 
{% block head_extra %}
{% endblock %} {% block content %}

{% set postsData = load_json('data/posts.json') %}
{% set post = postsData[0] %}
{% set premierLeague = load_json("data/leagues/premier-league.json") %}
{% set relatedPosts = postsData|slice(1, 4) %}

{% include '../components/page-header/page-header.twig' with {
  title: post.title|default('Post title'),
  subtitle: post.league|default('') ~ ' • ' ~ post.published_at|date('d M Y'),
  mod: 'compact',
  breadcrumbs: [
    { label: 'Home', url: '/' },
    { label: 'News', url: '/news' },
    { label: post.title|default('Post') }
  ]
} %}


<section class="section section--margin">
  <div class="container">
    <div class="post-layout">

      <article class="post-layout__content">
        
        <div class="post__meta">
          <div class="post__meta-item">
            <span class="material-symbols-outlined">person</span>
            <span>{{ post.author|default('Unknown') }}</span>
          </div>
          <div class="post__meta-item">
            <span class="material-symbols-outlined">schedule</span>
            <time datetime="{{ post.published_at|date('c') }}">
              {{ post.published_at|date('d F Y, H:i') }}
            </time>
          </div>
          <div class="post__meta-item">
            <span class="material-symbols-outlined">visibility</span>
            <span>1,234 views</span>
          </div>
        </div>

        {% if post.image %}
        <figure class="post__featured-image">
          <img 
            src="{{ post.image }}" 
            alt="{{ post.title }}"
            loading="eager"
          >
          {% if post.image_caption %}
          <figcaption>{{ post.image_caption }}</figcaption>
          {% endif %}
        </figure>
        {% endif %}

        {# Лид #}
        {% if post.lead %}
        <div class="post__lead">
          {{ post.lead }}
        </div>
        {% endif %}

        {# Основной контент #}
        <div class="post__content">
          {% for block in post.content|default([]) %}
            
            {% if block.type == 'text' %}
              <p>{{ block.text }}</p>
            
            {% elseif block.type == 'heading' %}
              <h2>{{ block.text }}</h2>
            
            {% elseif block.type == 'image' %}
              <figure class="post__image">
                <img 
                  src="{{ block.src }}" 
                  alt="{{ block.alt|default('') }}"
                  loading="lazy"
                >
                {% if block.caption %}
                <figcaption>{{ block.caption }}</figcaption>
                {% endif %}
              </figure>
            
            {% elseif block.type == 'quote' %}
              <blockquote class="post__quote">
                <p>{{ block.text }}</p>
                {% if block.author %}
                <cite>— {{ block.author }}</cite>
                {% endif %}
              </blockquote>
            
            {% elseif block.type == 'list' %}
              <ul class="post__list">
                {% for item in block.items %}
                <li>{{ item }}</li>
                {% endfor %}
              </ul>
            
            {% endif %}

          {% endfor %}
        </div>

        {# Теги #}
        {% if post.tags %}
        <div class="post__tags">
          {% for tag in post.tags %}
          <a href="{{ tag.href }}" class="post__tag">
            {{ tag.label }}
          </a>
          {% endfor %}
        </div>
        {% endif %}

      </article>
      <aside class="post-layout__sidebar">
        <div class="sidebar-widget">
          <h3 class="sidebar-widget__title">
            <span class="material-symbols-outlined">sports_soccer</span>
            Premier League
          </h3>
          
          {% include '../components/table/table.twig' with {
            variant: 'compact',
            columns: [
              { key: 'pos', label: '#', align: 'center', width: '32px' },
              { key: 'team', label: 'Team', type: 'team', align: 'left', width: '1fr' },
              { key: 'p', label: 'P', type: 'number', align: 'right', width: '40px' }
            ],
            rows: premierLeague|slice(0, 10)
          } only %}
          
          <a href="/league" class="sidebar-widget__more">
            View full table
            <span class="material-symbols-outlined">arrow_forward</span>
          </a>
        </div>
      </aside>

    </div>
  </div>
</section>
<section class="section section--margin">
  <div class="container">
    <div class="section__inner">
      {% include '../components/section-header/section-header.twig' with {
        title: 'More News',
        icon: 'article',
        more: 'See All News',
        more_href: '/news'
      } %}
      
      <div class="archive__grid archive__grid--news">     
        {% for newsPost in postsData|slice(5, 4) %}
          {% include '../components/card-post/card-post.twig' with { post: newsPost } %}
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endblock %} {% block scripts %}
{% endblock %}
